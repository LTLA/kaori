<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::ConstantTemplate&lt; N &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>kaori</b></li><li class="navelem"><a class="el" href="classkaori_1_1ConstantTemplate.html">ConstantTemplate</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1ConstantTemplate-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::ConstantTemplate&lt; N &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search a read sequence for a constant template sequence.  
 <a href="classkaori_1_1ConstantTemplate.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ConstantTemplate_8hpp_source.html">ConstantTemplate.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html">MatchDetails</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Details on the current match to the read sequence.  <a href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abc1c7821ab6511900e39b5c72ba99559"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1ConstantTemplate.html#abc1c7821ab6511900e39b5c72ba99559">ConstantTemplate</a> ()</td></tr>
<tr class="separator:abc1c7821ab6511900e39b5c72ba99559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa13feffd0fc518f14e289e763bf2b9ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1ConstantTemplate.html#aa13feffd0fc518f14e289e763bf2b9ce">ConstantTemplate</a> (const char *s, size_t n, bool f, bool r)</td></tr>
<tr class="separator:aa13feffd0fc518f14e289e763bf2b9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e598a424af7b108234b82cfa673eac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html">MatchDetails</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1ConstantTemplate.html#a84e598a424af7b108234b82cfa673eac">initialize</a> (const char *seq, size_t len) const</td></tr>
<tr class="separator:a84e598a424af7b108234b82cfa673eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a351a1faa9b1b50b98684132246df7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1ConstantTemplate.html#a40a351a1faa9b1b50b98684132246df7">next</a> (<a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html">MatchDetails</a> &amp;match) const</td></tr>
<tr class="separator:a40a351a1faa9b1b50b98684132246df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352c0b0f882053f8ab7ff0428f4bc46a"><td class="memTemplParams" colspan="2">template&lt;bool reverse = false&gt; </td></tr>
<tr class="memitem:a352c0b0f882053f8ab7ff0428f4bc46a"><td class="memTemplItemLeft" align="right" valign="top">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classkaori_1_1ConstantTemplate.html#a352c0b0f882053f8ab7ff0428f4bc46a">variable_regions</a> () const</td></tr>
<tr class="separator:a352c0b0f882053f8ab7ff0428f4bc46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t N&gt;<br />
class kaori::ConstantTemplate&lt; N &gt;</div><p >Search a read sequence for a constant template sequence. </p>
<p >The template sequence is expected to contain constant regions interspersed with one or more variable regions. This class will find the location on the read sequence that matches the constant regions of the template (give or take any number of substitutions). Once a match is found, the variable regions can be extracted for look-up with, e.g., the <code>VariableLibrary</code> class.</p>
<p >For efficiency, the search itself is done after converting all base sequences into a bit encoding. The maximum bit size of the encoding window is determined at compile-time using <code>N</code>. As four bits are used in the encoding, the maximum size of the constant template is <code>N / 4</code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">N</td><td>Size of the bitset used to represent the constant template sequence. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abc1c7821ab6511900e39b5c72ba99559" name="abc1c7821ab6511900e39b5c72ba99559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1c7821ab6511900e39b5c72ba99559">&#9670;&nbsp;</a></span>ConstantTemplate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1ConstantTemplate.html">kaori::ConstantTemplate</a>&lt; N &gt;::ConstantTemplate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Default constructor. This is only provided to enable composition, the resulting object should not be used until it is copy-assigned to a properly constructed instance. </p>

</div>
</div>
<a id="aa13feffd0fc518f14e289e763bf2b9ce" name="aa13feffd0fc518f14e289e763bf2b9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa13feffd0fc518f14e289e763bf2b9ce">&#9670;&nbsp;</a></span>ConstantTemplate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1ConstantTemplate.html">kaori::ConstantTemplate</a>&lt; N &gt;::ConstantTemplate </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Pointer to a character array containing the constant template. Constant sequences should only contain <code>A</code>, <code>C</code>, <code>G</code> or <code>T</code> (or their lower-case equivalents). Variable regions should be marked with <code>-</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Length of the array pointed to by <code>s</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f</td><td>Should the search be performed on the forward strand of the read sequence? </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">r</td><td>Should the search be performed on the reverse strand of the read sequence? </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a84e598a424af7b108234b82cfa673eac" name="a84e598a424af7b108234b82cfa673eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e598a424af7b108234b82cfa673eac">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html">MatchDetails</a> <a class="el" href="classkaori_1_1ConstantTemplate.html">kaori::ConstantTemplate</a>&lt; N &gt;::initialize </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Begin a new search for the template in a read sequence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Pointer to an array containing the read sequence. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">len</td><td>Length of the read sequence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html" title="Details on the current match to the read sequence.">MatchDetails</a></code> object that can be passed to <code><a class="el" href="classkaori_1_1ConstantTemplate.html#a40a351a1faa9b1b50b98684132246df7">next()</a></code>. </dd></dl>

</div>
</div>
<a id="a40a351a1faa9b1b50b98684132246df7" name="a40a351a1faa9b1b50b98684132246df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a351a1faa9b1b50b98684132246df7">&#9670;&nbsp;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1ConstantTemplate.html">kaori::ConstantTemplate</a>&lt; N &gt;::next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html">MatchDetails</a> &amp;&#160;</td>
          <td class="paramname"><em>match</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Find the next match in the read sequence. The first invocation will search for a match at position 0; this can be repeatedly called until <code>match.finished</code> is <code>true</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">match</td><td>A <code><a class="el" href="structkaori_1_1ConstantTemplate_1_1MatchDetails.html" title="Details on the current match to the read sequence.">MatchDetails</a></code> object produced by <code><a class="el" href="classkaori_1_1ConstantTemplate.html#a84e598a424af7b108234b82cfa673eac">initialize()</a></code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>match</code> is updated with the details of the current match at a particular position on the read sequence. </dd></dl>

</div>
</div>
<a id="a352c0b0f882053f8ab7ff0428f4bc46a" name="a352c0b0f882053f8ab7ff0428f4bc46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a352c0b0f882053f8ab7ff0428f4bc46a">&#9670;&nbsp;</a></span>variable_regions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<div class="memtemplate">
template&lt;bool reverse = false&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::pair&lt; int, int &gt; &gt; &amp; <a class="el" href="classkaori_1_1ConstantTemplate.html">kaori::ConstantTemplate</a>&lt; N &gt;::variable_regions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get the details about the variable regions in the constant template.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">reverse</td><td>Should we return the coordinates of the variable regions when searching on the reverse strand?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of pairs where each pair specifies the start and one-past-the-end position of each variable region in the template. Coordinates are reported relative to the start of the template. If <code>reverse = true</code>, coordinates are reported after reverse-complementing the template sequence. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="ConstantTemplate_8hpp_source.html">ConstantTemplate.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
