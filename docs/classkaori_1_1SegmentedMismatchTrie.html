<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::SegmentedMismatchTrie&lt; num_segments &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>kaori</b></li><li class="navelem"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html">SegmentedMismatchTrie</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1SegmentedMismatchTrie-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::SegmentedMismatchTrie&lt; num_segments &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Search for a sequence with segmented mismatches.  
 <a href="classkaori_1_1SegmentedMismatchTrie.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for kaori::SegmentedMismatchTrie&lt; num_segments &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classkaori_1_1SegmentedMismatchTrie__inherit__graph.png" border="0" usemap="#akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_inherit__map" id="akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_inherit__map">
<area shape="rect" title="Search for a sequence with segmented mismatches." alt="" coords="5,80,184,121"/>
<area shape="rect" href="classkaori_1_1MismatchTrie.html" title="Base class for the trie structure." alt="" coords="27,5,162,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for kaori::SegmentedMismatchTrie&lt; num_segments &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classkaori_1_1SegmentedMismatchTrie__coll__graph.png" border="0" usemap="#akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_coll__map" id="akaori_1_1SegmentedMismatchTrie_3_01num__segments_01_4_coll__map">
<area shape="rect" title="Search for a sequence with segmented mismatches." alt="" coords="5,80,184,121"/>
<area shape="rect" href="classkaori_1_1MismatchTrie.html" title="Base class for the trie structure." alt="" coords="27,5,162,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaori_1_1SegmentedMismatchTrie_1_1SearchResult.html">SearchResult</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result of the segmented search.  <a href="structkaori_1_1SegmentedMismatchTrie_1_1SearchResult.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adf0da5e635172512aa9e2744780f0c6f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html#adf0da5e635172512aa9e2744780f0c6f">SegmentedMismatchTrie</a> ()</td></tr>
<tr class="separator:adf0da5e635172512aa9e2744780f0c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ab159e54ed72c04d6854555ba8fb33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html#a75ab159e54ed72c04d6854555ba8fb33">SegmentedMismatchTrie</a> (std::array&lt; int, num_segments &gt; segments)</td></tr>
<tr class="separator:a75ab159e54ed72c04d6854555ba8fb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94d80334b22658074554e33837783f6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html#a94d80334b22658074554e33837783f6c">SegmentedMismatchTrie</a> (const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;seq, std::array&lt; int, num_segments &gt; segments, bool duplicates=false)</td></tr>
<tr class="separator:a94d80334b22658074554e33837783f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670a9b45fa4f5e37f0774f1e213a66d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaori_1_1SegmentedMismatchTrie_1_1SearchResult.html">SearchResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html#a670a9b45fa4f5e37f0774f1e213a66d8">search</a> (const char *seq, const std::array&lt; int, num_segments &gt; &amp;max_mismatches) const</td></tr>
<tr class="separator:a670a9b45fa4f5e37f0774f1e213a66d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classkaori_1_1MismatchTrie"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classkaori_1_1MismatchTrie')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classkaori_1_1MismatchTrie.html">kaori::MismatchTrie</a></td></tr>
<tr class="memitem:a7a2497c5a5913ac1f0094d4c1a9f7dcd inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1MismatchTrie.html#a7a2497c5a5913ac1f0094d4c1a9f7dcd">MismatchTrie</a> (size_t n=0)</td></tr>
<tr class="separator:a7a2497c5a5913ac1f0094d4c1a9f7dcd inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857e90888522bb7f4536516a61a324f8 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1MismatchTrie.html#a857e90888522bb7f4536516a61a324f8">MismatchTrie</a> (const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;seq, bool duplicates=false)</td></tr>
<tr class="separator:a857e90888522bb7f4536516a61a324f8 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9bd31952fa42f7b1cd8121ca20a80a1 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1MismatchTrie.html#af9bd31952fa42f7b1cd8121ca20a80a1">add</a> (const char *seq, bool duplicates=false)</td></tr>
<tr class="separator:af9bd31952fa42f7b1cd8121ca20a80a1 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59fa53197bedc1a0b5be0d1b64c6392 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1MismatchTrie.html#ab59fa53197bedc1a0b5be0d1b64c6392">get_length</a> () const</td></tr>
<tr class="separator:ab59fa53197bedc1a0b5be0d1b64c6392 inherit pub_methods_classkaori_1_1MismatchTrie"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t num_segments&gt;<br />
class kaori::SegmentedMismatchTrie&lt; num_segments &gt;</div><p >Search for a sequence with segmented mismatches. </p>
<p >Given a (typically read-derived) sequence, the trie allows us search for the best match to known sequences in a <code><a class="el" href="structkaori_1_1SequenceSet.html" title="Choice of sequences for a variable region.">SequenceSet</a></code>. This class restricts the distribution of mismatches in different segments of the sequence, e.g., 1 mismatch in the first 4 bp, 3 mismatches for the next 10 bp, and so on. The intention is to enable the use of the trie for concatenations of variable region sequences, where each segment is subject to a different number of mismatches.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">num_segments</td><td>Number of segments to consider. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adf0da5e635172512aa9e2744780f0c6f" name="adf0da5e635172512aa9e2744780f0c6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf0da5e635172512aa9e2744780f0c6f">&#9670;&nbsp;</a></span>SegmentedMismatchTrie() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html">kaori::SegmentedMismatchTrie</a>&lt; num_segments &gt;::SegmentedMismatchTrie </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Default constructor. </p>

</div>
</div>
<a id="a75ab159e54ed72c04d6854555ba8fb33" name="a75ab159e54ed72c04d6854555ba8fb33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ab159e54ed72c04d6854555ba8fb33">&#9670;&nbsp;</a></span>SegmentedMismatchTrie() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html">kaori::SegmentedMismatchTrie</a>&lt; num_segments &gt;::SegmentedMismatchTrie </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; int, num_segments &gt;&#160;</td>
          <td class="paramname"><em>segments</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segments</td><td>Length of each segment of the sequence. Each entry should be positive. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a94d80334b22658074554e33837783f6c" name="a94d80334b22658074554e33837783f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94d80334b22658074554e33837783f6c">&#9670;&nbsp;</a></span>SegmentedMismatchTrie() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1SegmentedMismatchTrie.html">kaori::SegmentedMismatchTrie</a>&lt; num_segments &gt;::SegmentedMismatchTrie </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; int, num_segments &gt;&#160;</td>
          <td class="paramname"><em>segments</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>duplicates</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>Possible set of known sequences for the variable region. </td></tr>
    <tr><td class="paramname">segments</td><td>Length of each segment of the sequence. Each entry should be positive. </td></tr>
    <tr><td class="paramname">duplicates</td><td>Whether duplicate sequences should be supported, see <code><a class="el" href="classkaori_1_1MismatchTrie.html#af9bd31952fa42f7b1cd8121ca20a80a1">add()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a670a9b45fa4f5e37f0774f1e213a66d8" name="a670a9b45fa4f5e37f0774f1e213a66d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a670a9b45fa4f5e37f0774f1e213a66d8">&#9670;&nbsp;</a></span>search()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t num_segments&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaori_1_1SegmentedMismatchTrie_1_1SearchResult.html">SearchResult</a> <a class="el" href="classkaori_1_1SegmentedMismatchTrie.html">kaori::SegmentedMismatchTrie</a>&lt; num_segments &gt;::search </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; int, num_segments &gt; &amp;&#160;</td>
          <td class="paramname"><em>max_mismatches</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Sequence to search for, typically derived from a read. This is assumed to be of length equal to <code><a class="el" href="classkaori_1_1MismatchTrie.html#ab59fa53197bedc1a0b5be0d1b64c6392">get_length()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_mismatches</td><td>Maximum number of mismatches for each segment. Each entry should be non-negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structkaori_1_1SegmentedMismatchTrie_1_1SearchResult.html" title="Result of the segmented search.">SearchResult</a></code> containing the index of the known sequence where the number of mismatches in each segment is less than or equal to <code>max_mismatches</code>.<ul>
<li>If multiple sequences satisfy this condition, the sequence with the lowest total number of mismatches is reported.</li>
<li>If multiple sequences share the same lowest total, the match is ambiguous and -1 is reported.</li>
<li>If no sequences satisfy the <code>max_mismatches</code> condition, -1 is reported. </li>
</ul>
</dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/<a class="el" href="MismatchTrie_8hpp_source.html">MismatchTrie.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
