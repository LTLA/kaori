<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>kaori: kaori::DualBarcodesWithDiagnostics&lt; N &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">kaori
   </div>
   <div id="projectbrief">A C++ library for barcode extraction and matching</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>kaori</b></li><li class="navelem"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">DualBarcodesWithDiagnostics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkaori_1_1DualBarcodesWithDiagnostics-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">kaori::DualBarcodesWithDiagnostics&lt; N &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Handler for dual barcodes with extra diagnostics.  
 <a href="classkaori_1_1DualBarcodesWithDiagnostics.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DualBarcodesWithDiagnostics_8hpp_source.html">DualBarcodesWithDiagnostics.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a96dd3a4ffd391f98b414c708aacf8beb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#a96dd3a4ffd391f98b414c708aacf8beb">DualBarcodesWithDiagnostics</a> (const char *con1, size_t n1, bool rev1, const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;var1, int mm1, const char *con2, size_t n2, bool rev2, const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;var2, int mm2, bool random=false)</td></tr>
<tr class="separator:a96dd3a4ffd391f98b414c708aacf8beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e3485ead508eadd20994fd9e797112"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">DualBarcodesWithDiagnostics</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#ac5e3485ead508eadd20994fd9e797112">set_first</a> (bool t=true)</td></tr>
<tr class="separator:ac5e3485ead508eadd20994fd9e797112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a821c3e68603a4ba8ab5cf7a51d5fcde3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#a821c3e68603a4ba8ab5cf7a51d5fcde3">sort</a> ()</td></tr>
<tr class="separator:a821c3e68603a4ba8ab5cf7a51d5fcde3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a6f34f9b4077560a0257bb59144c27"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#a43a6f34f9b4077560a0257bb59144c27">get_counts</a> () const</td></tr>
<tr class="separator:a43a6f34f9b4077560a0257bb59144c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaff965ef08b712326bfe2d04976c0a2"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::array&lt; int, 2 &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#acaff965ef08b712326bfe2d04976c0a2">get_combinations</a> () const</td></tr>
<tr class="separator:acaff965ef08b712326bfe2d04976c0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad4964954520c152969574fe62d81153"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#aad4964954520c152969574fe62d81153">get_total</a> () const</td></tr>
<tr class="separator:aad4964954520c152969574fe62d81153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80aa90572974132e782d2027e32f66af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#a80aa90572974132e782d2027e32f66af">get_barcode1_only</a> () const</td></tr>
<tr class="separator:a80aa90572974132e782d2027e32f66af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890307e2fb11b2e6c99ebcdf1e94b6e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html#a890307e2fb11b2e6c99ebcdf1e94b6e6">get_barcode2_only</a> () const</td></tr>
<tr class="separator:a890307e2fb11b2e6c99ebcdf1e94b6e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t N&gt;<br />
class kaori::DualBarcodesWithDiagnostics&lt; N &gt;</div><p >Handler for dual barcodes with extra diagnostics. </p>
<p >This provides the same information as <code><a class="el" href="classkaori_1_1DualBarcodes.html" title="Handler for dual barcodes.">DualBarcodes</a></code> but also captures the frequency of the invalid combinations. These frequences can be helpful for diagnosing problems with library construction. The handler also counts the number of reads where only one barcode construct matches to a read.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">N</td><td>Size of the bitset to use for each constant template. The maximum size of the template is defined as <code>N / 4</code>, see <code><a class="el" href="classkaori_1_1ConstantTemplate.html" title="Search a read sequence for a constant template sequence.">ConstantTemplate</a></code> for details. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a96dd3a4ffd391f98b414c708aacf8beb" name="a96dd3a4ffd391f98b414c708aacf8beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96dd3a4ffd391f98b414c708aacf8beb">&#9670;&nbsp;</a></span>DualBarcodesWithDiagnostics()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::DualBarcodesWithDiagnostics </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>con1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rev1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;&#160;</td>
          <td class="paramname"><em>var1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>con2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rev2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaori_1_1SequenceSet.html">SequenceSet</a> &amp;&#160;</td>
          <td class="paramname"><em>var2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mm2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>random</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">con1</td><td>Template sequence for the first barcode. This should contain one variable region. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n1</td><td>Length of the first barcode template. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rev1</td><td>Whether to search the reverse strand for the first barcode template. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">var1</td><td>Set of known sequences for the variable region in the first barcode. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mm1</td><td>Maximum number of mismatches for the first barcode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">con2</td><td>Template sequence for the second barcode. This should contain one variable region. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n2</td><td>Length of the second barcode template. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rev2</td><td>Whether to search the reverse strand for the second barcode template. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">var2</td><td>Set of known sequences for the variable region in the second barcode. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mm2</td><td>Maximum number of mismatches for the second barcode. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">random</td><td>Whether the reads are randomized with respect to the first/second barcode. If <code>false</code>, the first read is searched for the first barcode only, and the second read is searched for the second barcode only. If <code>true</code>, an additional search will be performed in the opposite orientation.</td></tr>
  </table>
  </dd>
</dl>
<p><code>var2</code> and <code>var1</code> are assumed to have the same number of barcodes. Corresponding values across <code>var1</code> and <code>var2</code> define a particular combination. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a80aa90572974132e782d2027e32f66af" name="a80aa90572974132e782d2027e32f66af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80aa90572974132e782d2027e32f66af">&#9670;&nbsp;</a></span>get_barcode1_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::get_barcode1_only </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Number of read pairs with a valid match to the first barcode but no valid match to the second barcode. </dd></dl>

</div>
</div>
<a id="a890307e2fb11b2e6c99ebcdf1e94b6e6" name="a890307e2fb11b2e6c99ebcdf1e94b6e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a890307e2fb11b2e6c99ebcdf1e94b6e6">&#9670;&nbsp;</a></span>get_barcode2_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::get_barcode2_only </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Number of read pairs with a valid match to the second barcode but no valid match to the first barcode. </dd></dl>

</div>
</div>
<a id="acaff965ef08b712326bfe2d04976c0a2" name="acaff965ef08b712326bfe2d04976c0a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaff965ef08b712326bfe2d04976c0a2">&#9670;&nbsp;</a></span>get_combinations()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::array&lt; int, 2 &gt; &gt; &amp; <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::get_combinations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>All invalid combinations encountered by the handler. </dd></dl>

</div>
</div>
<a id="a43a6f34f9b4077560a0257bb59144c27" name="a43a6f34f9b4077560a0257bb59144c27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a6f34f9b4077560a0257bb59144c27">&#9670;&nbsp;</a></span>get_counts()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; int &gt; &amp; <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::get_counts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Vector containing the frequency of each combination. This has length equal to the number of valid combinations (i.e., the length of <code>var1</code> and <code>var2</code> in the constructor). </dd></dl>

</div>
</div>
<a id="aad4964954520c152969574fe62d81153" name="aad4964954520c152969574fe62d81153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad4964954520c152969574fe62d81153">&#9670;&nbsp;</a></span>get_total()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::get_total </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Total number of read pairs processed by the handler. </dd></dl>

</div>
</div>
<a id="ac5e3485ead508eadd20994fd9e797112" name="ac5e3485ead508eadd20994fd9e797112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e3485ead508eadd20994fd9e797112">&#9670;&nbsp;</a></span>set_first()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">DualBarcodesWithDiagnostics</a> &amp; <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::set_first </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>t</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Whether to search only for the first match across reads (for valid combinations) or in each read (for invalid combinations). If <code>false</code>, the handler will search for the best match (i.e., fewest mismatches) instead.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html" title="Handler for dual barcodes with extra diagnostics.">DualBarcodesWithDiagnostics</a></code> instance. </dd></dl>

</div>
</div>
<a id="a821c3e68603a4ba8ab5cf7a51d5fcde3" name="a821c3e68603a4ba8ab5cf7a51d5fcde3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a821c3e68603a4ba8ab5cf7a51d5fcde3">&#9670;&nbsp;</a></span>sort()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkaori_1_1DualBarcodesWithDiagnostics.html">kaori::DualBarcodesWithDiagnostics</a>&lt; N &gt;::sort </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Sort the invalid combinations for easier frequency counting. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>kaori/handlers/<a class="el" href="DualBarcodesWithDiagnostics_8hpp_source.html">DualBarcodesWithDiagnostics.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
